
  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/

 :: Spring Boot ::                (v3.5.6)

2025-10-21 17:41:12 [main] INFO  c.e.C.ContractReviewApplication - Starting ContractReviewApplication v0.0.1-SNAPSHOT using Java 17.0.16 with PID 11104 (D:\工作\合同审查系统开发\spring boot\Contract_review\target\app.jar started by Administrator in D:\工作\合同审查系统开发\spring boot\Contract_review)
2025-10-21 17:41:12 [main] DEBUG c.e.C.ContractReviewApplication - Running with Spring Boot v3.5.6, Spring v6.2.11
2025-10-21 17:41:12 [main] INFO  c.e.C.ContractReviewApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-21 17:41:14 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 9999 (http)
2025-10-21 17:41:14 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-10-21 17:41:14 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.46]
2025-10-21 17:41:14 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-10-21 17:41:14 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2774 ms
2025-10-21 17:41:15 [main] INFO  c.e.C.service.ReviewStandardService - 审查标准初始化完成: 标准数=2, 模板数=3
2025-10-21 17:41:15 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-10-21 17:41:15 [main] WARN  o.s.w.s.r.ResourceHandlerUtils - Appended trailing slash to static resource location: classpath:/static/index.html/
2025-10-21 17:41:16 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 9999 (http) with context path '/'
2025-10-21 17:41:16 [main] INFO  c.e.C.ContractReviewApplication - Started ContractReviewApplication in 5.229 seconds (process running for 6.264)
2025-10-21 17:42:03 [http-nio-9999-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-10-21 17:42:03 [http-nio-9999-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-10-21 17:42:03 [http-nio-9999-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-10-21 17:42:03 [http-nio-9999-exec-1] INFO  c.e.C.c.ChatGPTIntegrationController - 为ChatGPT生成提示: filename=??????_???????.docx, contractType=通用合同, anchors=generate
2025-10-21 17:42:03 [http-nio-9999-exec-1] INFO  c.e.C.service.ContractParseService - 开始解析合同并生成带锚点文档: filename=??????_???????.docx, anchorMode=generate
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【修复版本】开始提取条款（使用正确的真实段落索引）
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 总段落数=44, 生成锚点=true
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '技术服务合同（综合测试版）'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '合同编号：TEST-2025-001'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '签订日期：2025-10-15'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '甲方（委托方）：华南科技有限公司'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '乙方（受托方）：智创信息技术有限公司'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - ? 发现条款 [clauseId=c1] 在真实段落索引 [5]，标题: '一、合同目的与背景'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '本合同旨在明确双方在软件开发、技术交付、知识产权、数据安全、保密义务及后期维护等方面的权利与义务，以确保项目顺利进行。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '本合同旨在明确双方在软件开发、技术交付、知识产权、数据安全、保密义务及后期维护等方面的权利与义务，以确保项目顺利进行。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 生成确定性锚点: clauseId=c1, heading=一、合同目的与背景, anchorId=anc-c1-304286e3
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils -   生成锚点: anchorId=anc-c1-304286e3
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 条款对象创建: id=c1, 锚点=anc-c1-304286e3, 真实段落范围=[5-7]
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '本合同旨在明确双方在软件开发、技术交付、知识产权、数据安全、保密义务及后期维护等方面的权利与义务，以确保项目顺利进行。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '本合同旨在明确双方在软件开发、技术交付、知识产权、数据安全、保密义务及后期维护等方面的权利与义务，以确保项目顺利进行。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - ? 发现条款 [clauseId=c2] 在真实段落索引 [9]，标题: '二、项目内容与交付物'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 生成确定性锚点: clauseId=c2, heading=二、项目内容与交付物, anchorId=anc-c2-9de47575
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils -   生成锚点: anchorId=anc-c2-9de47575
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 条款对象创建: id=c2, 锚点=anc-c2-9de47575, 真实段落范围=[9-9]
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - ? 发现条款 [clauseId=c3] 在真实段落索引 [10]，标题: '1. 乙方负责开发并交付“智能合同审查系统”，包括以下模块：'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '（1）合同解析模块（Word/PDF支持）'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '（2）审查规则引擎（基于AI模型）'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '（3）前端展示与标注界面（Web版）'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 生成确定性锚点: clauseId=c3, heading=1. 乙方负责开发并交付“智能合同审查系..., anchorId=anc-c3-ea3ec6c4
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils -   生成锚点: anchorId=anc-c3-ea3ec6c4
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 条款对象创建: id=c3, 锚点=anc-c3-ea3ec6c4, 真实段落范围=[10-13]
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '（1）合同解析模块（Word/PDF支持）'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '（2）审查规则引擎（基于AI模型）'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '（3）前端展示与标注界面（Web版）'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - ? 发现条款 [clauseId=c4] 在真实段落索引 [14]，标题: '2. 项目分阶段交付，具体如下表所示：'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 生成确定性锚点: clauseId=c4, heading=2. 项目分阶段交付，具体如下表所示：, anchorId=anc-c4-81b83145
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils -   生成锚点: anchorId=anc-c4-81b83145
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 条款对象创建: id=c4, 锚点=anc-c4-81b83145, 真实段落范围=[14-14]
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - ? 发现条款 [clauseId=c5] 在真实段落索引 [15]，标题: '三、合同金额与付款方式'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 生成确定性锚点: clauseId=c5, heading=三、合同金额与付款方式, anchorId=anc-c5-28115872
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils -   生成锚点: anchorId=anc-c5-28115872
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 条款对象创建: id=c5, 锚点=anc-c5-28115872, 真实段落范围=[15-15]
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - ? 发现条款 [clauseId=c6] 在真实段落索引 [16]，标题: '1. 合同总金额为人民币叁拾万元整（￥300,000）。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 生成确定性锚点: clauseId=c6, heading=1. 合同总金额为人民币叁拾万元整（￥3..., anchorId=anc-c6-61522cc8
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils -   生成锚点: anchorId=anc-c6-61522cc8
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 条款对象创建: id=c6, 锚点=anc-c6-61522cc8, 真实段落范围=[16-16]
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - ? 发现条款 [clauseId=c7] 在真实段落索引 [17]，标题: '2. 付款方式如下：'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '- 首付款：合同签订后7个工作日内支付30%；'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '- 中期款：第二阶段通过验收后支付40%；'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '- 尾款：项目最终验收合格后支付30%。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 生成确定性锚点: clauseId=c7, heading=2. 付款方式如下：, anchorId=anc-c7-b36a73c2
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils -   生成锚点: anchorId=anc-c7-b36a73c2
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 条款对象创建: id=c7, 锚点=anc-c7-b36a73c2, 真实段落范围=[17-20]
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '- 首付款：合同签订后7个工作日内支付30%；'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '- 中期款：第二阶段通过验收后支付40%；'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '- 尾款：项目最终验收合格后支付30%。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - ? 发现条款 [clauseId=c8] 在真实段落索引 [21]，标题: '四、知识产权条款'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 生成确定性锚点: clauseId=c8, heading=四、知识产权条款, anchorId=anc-c8-291e4a0a
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils -   生成锚点: anchorId=anc-c8-291e4a0a
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 条款对象创建: id=c8, 锚点=anc-c8-291e4a0a, 真实段落范围=[21-21]
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - ? 发现条款 [clauseId=c9] 在真实段落索引 [22]，标题: '1. 所有项目成果的知识产权归甲方所有，乙方仅保留开发经验与通用算法的使用权。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 生成确定性锚点: clauseId=c9, heading=1. 所有项目成果的知识产权归甲方所有，..., anchorId=anc-c9-3c2638dc
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils -   生成锚点: anchorId=anc-c9-3c2638dc
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 条款对象创建: id=c9, 锚点=anc-c9-3c2638dc, 真实段落范围=[22-22]
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - ? 发现条款 [clauseId=c10] 在真实段落索引 [23]，标题: '2. 未经甲方书面许可，乙方不得将项目成果向第三方披露、转让或再开发。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 生成确定性锚点: clauseId=c10, heading=2. 未经甲方书面许可，乙方不得将项目成..., anchorId=anc-c10-884a5461
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils -   生成锚点: anchorId=anc-c10-884a5461
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 条款对象创建: id=c10, 锚点=anc-c10-884a5461, 真实段落范围=[23-23]
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - ? 发现条款 [clauseId=c11] 在真实段落索引 [24]，标题: '五、保密与数据安全'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 生成确定性锚点: clauseId=c11, heading=五、保密与数据安全, anchorId=anc-c11-7dc75b7d
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils -   生成锚点: anchorId=anc-c11-7dc75b7d
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 条款对象创建: id=c11, 锚点=anc-c11-7dc75b7d, 真实段落范围=[24-24]
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - ? 发现条款 [clauseId=c12] 在真实段落索引 [25]，标题: '1. 双方均应对在合作过程中知悉的商业秘密予以保密。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 生成确定性锚点: clauseId=c12, heading=1. 双方均应对在合作过程中知悉的商业秘..., anchorId=anc-c12-57dbc9fc
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils -   生成锚点: anchorId=anc-c12-57dbc9fc
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 条款对象创建: id=c12, 锚点=anc-c12-57dbc9fc, 真实段落范围=[25-25]
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - ? 发现条款 [clauseId=c13] 在真实段落索引 [26]，标题: '2. 乙方应确保甲方数据在传输、存储和处理过程中的安全性，不得外泄或擅自使用。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 生成确定性锚点: clauseId=c13, heading=2. 乙方应确保甲方数据在传输、存储和处..., anchorId=anc-c13-3fab89f0
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils -   生成锚点: anchorId=anc-c13-3fab89f0
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 条款对象创建: id=c13, 锚点=anc-c13-3fab89f0, 真实段落范围=[26-26]
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - ? 发现条款 [clauseId=c14] 在真实段落索引 [27]，标题: '3. 保密期限自合同生效起至合同终止后五年内有效。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 生成确定性锚点: clauseId=c14, heading=3. 保密期限自合同生效起至合同终止后五..., anchorId=anc-c14-c1f1f7e5
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils -   生成锚点: anchorId=anc-c14-c1f1f7e5
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 条款对象创建: id=c14, 锚点=anc-c14-c1f1f7e5, 真实段落范围=[27-27]
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - ? 发现条款 [clauseId=c15] 在真实段落索引 [28]，标题: '六、违约责任'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 生成确定性锚点: clauseId=c15, heading=六、违约责任, anchorId=anc-c15-d0471f05
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils -   生成锚点: anchorId=anc-c15-d0471f05
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 条款对象创建: id=c15, 锚点=anc-c15-d0471f05, 真实段落范围=[28-28]
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - ? 发现条款 [clauseId=c16] 在真实段落索引 [29]，标题: '1. 任一方违反合同约定，须赔偿对方因此造成的全部经济损失。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 生成确定性锚点: clauseId=c16, heading=1. 任一方违反合同约定，须赔偿对方因此..., anchorId=anc-c16-4d20610c
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils -   生成锚点: anchorId=anc-c16-4d20610c
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 条款对象创建: id=c16, 锚点=anc-c16-4d20610c, 真实段落范围=[29-29]
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - ? 发现条款 [clauseId=c17] 在真实段落索引 [30]，标题: '2. 若乙方延误交付时间超过15日，甲方有权解除合同并要求退还已付款项。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 生成确定性锚点: clauseId=c17, heading=2. 若乙方延误交付时间超过15日，甲方..., anchorId=anc-c17-2c6d0d52
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils -   生成锚点: anchorId=anc-c17-2c6d0d52
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 条款对象创建: id=c17, 锚点=anc-c17-2c6d0d52, 真实段落范围=[30-30]
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - ? 发现条款 [clauseId=c18] 在真实段落索引 [31]，标题: '七、合同期限与终止'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '合同有效期为2025年1月1日至2025年12月31日。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 生成确定性锚点: clauseId=c18, heading=七、合同期限与终止, anchorId=anc-c18-4eeb43d4
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils -   生成锚点: anchorId=anc-c18-4eeb43d4
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 条款对象创建: id=c18, 锚点=anc-c18-4eeb43d4, 真实段落范围=[31-32]
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '合同有效期为2025年1月1日至2025年12月31日。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - ? 发现条款 [clauseId=c19] 在真实段落索引 [33]，标题: '若一方严重违约，另一方有权提前终止合同。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 生成确定性锚点: clauseId=c19, heading=若一方严重违约，另一方有权提前终止合同。, anchorId=anc-c19-80d2f88c
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils -   生成锚点: anchorId=anc-c19-80d2f88c
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 条款对象创建: id=c19, 锚点=anc-c19-80d2f88c, 真实段落范围=[33-33]
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - ? 发现条款 [clauseId=c20] 在真实段落索引 [34]，标题: '八、争议解决'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '合同履行中如发生争议，双方应友好协商解决；协商不成的，提交广州仲裁委员会仲裁。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 生成确定性锚点: clauseId=c20, heading=八、争议解决, anchorId=anc-c20-499e999d
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils -   生成锚点: anchorId=anc-c20-499e999d
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 条款对象创建: id=c20, 锚点=anc-c20-499e999d, 真实段落范围=[34-35]
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '合同履行中如发生争议，双方应友好协商解决；协商不成的，提交广州仲裁委员会仲裁。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - ? 发现条款 [clauseId=c21] 在真实段落索引 [36]，标题: '九、附则'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 生成确定性锚点: clauseId=c21, heading=九、附则, anchorId=anc-c21-9d843cbb
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils -   生成锚点: anchorId=anc-c21-9d843cbb
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 条款对象创建: id=c21, 锚点=anc-c21-9d843cbb, 真实段落范围=[36-36]
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - ? 发现条款 [clauseId=c22] 在真实段落索引 [37]，标题: '1. 本合同未尽事宜，双方可签署补充协议，补充协议与本合同具有同等法律效力。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 生成确定性锚点: clauseId=c22, heading=1. 本合同未尽事宜，双方可签署补充协议..., anchorId=anc-c22-5bfe3c7f
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils -   生成锚点: anchorId=anc-c22-5bfe3c7f
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 条款对象创建: id=c22, 锚点=anc-c22-5bfe3c7f, 真实段落范围=[37-37]
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - ? 发现条款 [clauseId=c23] 在真实段落索引 [38]，标题: '2. 本合同一式两份，双方各执一份。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: ''
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '（以下无正文，为签署页）'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '甲方代表（签章）：_________________'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '乙方代表（签章）：_________________'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '签署日期：2025-10-15'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 生成确定性锚点: clauseId=c23, heading=2. 本合同一式两份，双方各执一份。, anchorId=anc-c23-c587774a
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils -   生成锚点: anchorId=anc-c23-c587774a
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 条款对象创建: id=c23, 锚点=anc-c23-c587774a, 真实段落范围=[38-43]
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: ''
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '（以下无正文，为签署页）'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '甲方代表（签章）：_________________'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '乙方代表（签章）：_________________'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 段落不符合条款标题规则: '签署日期：2025-10-15'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【修复版本】条款提取完成: 共找到 23 个条款
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【验证】开始验证条款索引一致性...
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - ? 索引一致: clauseId=c1, startParaIndex=5, 文本='一、合同目的与背景'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - ? 索引一致: clauseId=c2, startParaIndex=9, 文本='二、项目内容与交付物'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - ? 索引一致: clauseId=c3, startParaIndex=10, 文本='1. 乙方负责开发并交付“智能合同审查系统”，包括以下模块：'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - ? 索引一致: clauseId=c4, startParaIndex=14, 文本='2. 项目分阶段交付，具体如下表所示：'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - ? 索引一致: clauseId=c5, startParaIndex=15, 文本='三、合同金额与付款方式'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - ? 索引一致: clauseId=c6, startParaIndex=16, 文本='1. 合同总金额为人民币叁拾万元整（￥300,000）。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - ? 索引一致: clauseId=c7, startParaIndex=17, 文本='2. 付款方式如下：'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - ? 索引一致: clauseId=c8, startParaIndex=21, 文本='四、知识产权条款'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - ? 索引一致: clauseId=c9, startParaIndex=22, 文本='1. 所有项目成果的知识产权归甲方所有，乙方仅保留开发经验与通用算法的使用权。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - ? 索引一致: clauseId=c10, startParaIndex=23, 文本='2. 未经甲方书面许可，乙方不得将项目成果向第三方披露、转让或再开发。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - ? 索引一致: clauseId=c11, startParaIndex=24, 文本='五、保密与数据安全'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - ? 索引一致: clauseId=c12, startParaIndex=25, 文本='1. 双方均应对在合作过程中知悉的商业秘密予以保密。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - ? 索引一致: clauseId=c13, startParaIndex=26, 文本='2. 乙方应确保甲方数据在传输、存储和处理过程中的安全性，不得外泄或擅自使用。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - ? 索引一致: clauseId=c14, startParaIndex=27, 文本='3. 保密期限自合同生效起至合同终止后五年内有效。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - ? 索引一致: clauseId=c15, startParaIndex=28, 文本='六、违约责任'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - ? 索引一致: clauseId=c16, startParaIndex=29, 文本='1. 任一方违反合同约定，须赔偿对方因此造成的全部经济损失。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - ? 索引一致: clauseId=c17, startParaIndex=30, 文本='2. 若乙方延误交付时间超过15日，甲方有权解除合同并要求退还已付款项。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - ? 索引一致: clauseId=c18, startParaIndex=31, 文本='七、合同期限与终止'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - ? 索引一致: clauseId=c19, startParaIndex=33, 文本='若一方严重违约，另一方有权提前终止合同。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - ? 索引一致: clauseId=c20, startParaIndex=34, 文本='八、争议解决'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - ? 索引一致: clauseId=c21, startParaIndex=36, 文本='九、附则'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - ? 索引一致: clauseId=c22, startParaIndex=37, 文本='1. 本合同未尽事宜，双方可签署补充协议，补充协议与本合同具有同等法律效力。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - ? 索引一致: clauseId=c23, startParaIndex=38, 文本='2. 本合同一式两份，双方各执一份。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - ? 所有条款索引验证通过！
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.C.service.ContractParseService - 【工作流】开始插入锚点到文档中
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】开始插入锚点: 文档段落数=44, 条款数=23
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】条款[0]: id=c1, anchorId=anc-c1-304286e3, startParaIndex=5, heading='一、合同目的与背景'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】条款[1]: id=c2, anchorId=anc-c2-9de47575, startParaIndex=9, heading='二、项目内容与交付物'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】条款[2]: id=c3, anchorId=anc-c3-ea3ec6c4, startParaIndex=10, heading='1. 乙方负责开发并交付“智能合同审查系统”，包括以下模块：'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】条款[3]: id=c4, anchorId=anc-c4-81b83145, startParaIndex=14, heading='2. 项目分阶段交付，具体如下表所示：'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】条款[4]: id=c5, anchorId=anc-c5-28115872, startParaIndex=15, heading='三、合同金额与付款方式'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】条款[5]: id=c6, anchorId=anc-c6-61522cc8, startParaIndex=16, heading='1. 合同总金额为人民币叁拾万元整（￥300,000）。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】条款[6]: id=c7, anchorId=anc-c7-b36a73c2, startParaIndex=17, heading='2. 付款方式如下：'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】条款[7]: id=c8, anchorId=anc-c8-291e4a0a, startParaIndex=21, heading='四、知识产权条款'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】条款[8]: id=c9, anchorId=anc-c9-3c2638dc, startParaIndex=22, heading='1. 所有项目成果的知识产权归甲方所有，乙方仅保留开发经验与通用算法的使用权。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】条款[9]: id=c10, anchorId=anc-c10-884a5461, startParaIndex=23, heading='2. 未经甲方书面许可，乙方不得将项目成果向第三方披露、转让或再开发。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】条款[10]: id=c11, anchorId=anc-c11-7dc75b7d, startParaIndex=24, heading='五、保密与数据安全'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】条款[11]: id=c12, anchorId=anc-c12-57dbc9fc, startParaIndex=25, heading='1. 双方均应对在合作过程中知悉的商业秘密予以保密。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】条款[12]: id=c13, anchorId=anc-c13-3fab89f0, startParaIndex=26, heading='2. 乙方应确保甲方数据在传输、存储和处理过程中的安全性，不得外泄或擅自使用。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】条款[13]: id=c14, anchorId=anc-c14-c1f1f7e5, startParaIndex=27, heading='3. 保密期限自合同生效起至合同终止后五年内有效。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】条款[14]: id=c15, anchorId=anc-c15-d0471f05, startParaIndex=28, heading='六、违约责任'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】条款[15]: id=c16, anchorId=anc-c16-4d20610c, startParaIndex=29, heading='1. 任一方违反合同约定，须赔偿对方因此造成的全部经济损失。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】条款[16]: id=c17, anchorId=anc-c17-2c6d0d52, startParaIndex=30, heading='2. 若乙方延误交付时间超过15日，甲方有权解除合同并要求退还已付款项。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】条款[17]: id=c18, anchorId=anc-c18-4eeb43d4, startParaIndex=31, heading='七、合同期限与终止'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】条款[18]: id=c19, anchorId=anc-c19-80d2f88c, startParaIndex=33, heading='若一方严重违约，另一方有权提前终止合同。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】条款[19]: id=c20, anchorId=anc-c20-499e999d, startParaIndex=34, heading='八、争议解决'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】条款[20]: id=c21, anchorId=anc-c21-9d843cbb, startParaIndex=36, heading='九、附则'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】条款[21]: id=c22, anchorId=anc-c22-5bfe3c7f, startParaIndex=37, heading='1. 本合同未尽事宜，双方可签署补充协议，补充协议与本合同具有同等法律效力。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】条款[22]: id=c23, anchorId=anc-c23-c587774a, startParaIndex=38, heading='2. 本合同一式两份，双方各执一份。'
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】为条款添加书签: clauseId=c1, anchorId=anc-c1-304286e3, paraIndex=5
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】段落当前书签数: 0
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】书签已添加: bookmarkName=anc-c1-304286e3, bookmarkId=724545, 段落现在有1个书签
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】为条款添加书签: clauseId=c2, anchorId=anc-c2-9de47575, paraIndex=9
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】段落当前书签数: 0
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】书签已添加: bookmarkName=anc-c2-9de47575, bookmarkId=724551, 段落现在有1个书签
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】为条款添加书签: clauseId=c3, anchorId=anc-c3-ea3ec6c4, paraIndex=10
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】段落当前书签数: 0
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】书签已添加: bookmarkName=anc-c3-ea3ec6c4, bookmarkId=724552, 段落现在有1个书签
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】为条款添加书签: clauseId=c4, anchorId=anc-c4-81b83145, paraIndex=14
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】段落当前书签数: 0
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】书签已添加: bookmarkName=anc-c4-81b83145, bookmarkId=724552, 段落现在有1个书签
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】为条款添加书签: clauseId=c5, anchorId=anc-c5-28115872, paraIndex=15
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】段落当前书签数: 0
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】书签已添加: bookmarkName=anc-c5-28115872, bookmarkId=724553, 段落现在有1个书签
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】为条款添加书签: clauseId=c6, anchorId=anc-c6-61522cc8, paraIndex=16
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】段落当前书签数: 0
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】书签已添加: bookmarkName=anc-c6-61522cc8, bookmarkId=724553, 段落现在有1个书签
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】为条款添加书签: clauseId=c7, anchorId=anc-c7-b36a73c2, paraIndex=17
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】段落当前书签数: 0
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】书签已添加: bookmarkName=anc-c7-b36a73c2, bookmarkId=724553, 段落现在有1个书签
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】为条款添加书签: clauseId=c8, anchorId=anc-c8-291e4a0a, paraIndex=21
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】段落当前书签数: 0
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】书签已添加: bookmarkName=anc-c8-291e4a0a, bookmarkId=724553, 段落现在有1个书签
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】为条款添加书签: clauseId=c9, anchorId=anc-c9-3c2638dc, paraIndex=22
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】段落当前书签数: 0
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】书签已添加: bookmarkName=anc-c9-3c2638dc, bookmarkId=724556, 段落现在有1个书签
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】为条款添加书签: clauseId=c10, anchorId=anc-c10-884a5461, paraIndex=23
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】段落当前书签数: 0
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】书签已添加: bookmarkName=anc-c10-884a5461, bookmarkId=724556, 段落现在有1个书签
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】为条款添加书签: clauseId=c11, anchorId=anc-c11-7dc75b7d, paraIndex=24
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】段落当前书签数: 0
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】书签已添加: bookmarkName=anc-c11-7dc75b7d, bookmarkId=724556, 段落现在有1个书签
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】为条款添加书签: clauseId=c12, anchorId=anc-c12-57dbc9fc, paraIndex=25
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】段落当前书签数: 0
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】书签已添加: bookmarkName=anc-c12-57dbc9fc, bookmarkId=724557, 段落现在有1个书签
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】为条款添加书签: clauseId=c13, anchorId=anc-c13-3fab89f0, paraIndex=26
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】段落当前书签数: 0
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】书签已添加: bookmarkName=anc-c13-3fab89f0, bookmarkId=724557, 段落现在有1个书签
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】为条款添加书签: clauseId=c14, anchorId=anc-c14-c1f1f7e5, paraIndex=27
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】段落当前书签数: 0
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】书签已添加: bookmarkName=anc-c14-c1f1f7e5, bookmarkId=724558, 段落现在有1个书签
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】为条款添加书签: clauseId=c15, anchorId=anc-c15-d0471f05, paraIndex=28
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】段落当前书签数: 0
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】书签已添加: bookmarkName=anc-c15-d0471f05, bookmarkId=724559, 段落现在有1个书签
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】为条款添加书签: clauseId=c16, anchorId=anc-c16-4d20610c, paraIndex=29
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】段落当前书签数: 0
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】书签已添加: bookmarkName=anc-c16-4d20610c, bookmarkId=724560, 段落现在有1个书签
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】为条款添加书签: clauseId=c17, anchorId=anc-c17-2c6d0d52, paraIndex=30
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】段落当前书签数: 0
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】书签已添加: bookmarkName=anc-c17-2c6d0d52, bookmarkId=724560, 段落现在有1个书签
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】为条款添加书签: clauseId=c18, anchorId=anc-c18-4eeb43d4, paraIndex=31
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】段落当前书签数: 0
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】书签已添加: bookmarkName=anc-c18-4eeb43d4, bookmarkId=724560, 段落现在有1个书签
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】为条款添加书签: clauseId=c19, anchorId=anc-c19-80d2f88c, paraIndex=33
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】段落当前书签数: 0
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】书签已添加: bookmarkName=anc-c19-80d2f88c, bookmarkId=724560, 段落现在有1个书签
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】为条款添加书签: clauseId=c20, anchorId=anc-c20-499e999d, paraIndex=34
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】段落当前书签数: 0
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】书签已添加: bookmarkName=anc-c20-499e999d, bookmarkId=724561, 段落现在有1个书签
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】为条款添加书签: clauseId=c21, anchorId=anc-c21-9d843cbb, paraIndex=36
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】段落当前书签数: 0
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】书签已添加: bookmarkName=anc-c21-9d843cbb, bookmarkId=724561, 段落现在有1个书签
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】为条款添加书签: clauseId=c22, anchorId=anc-c22-5bfe3c7f, paraIndex=37
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】段落当前书签数: 0
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】书签已添加: bookmarkName=anc-c22-5bfe3c7f, bookmarkId=724562, 段落现在有1个书签
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】为条款添加书签: clauseId=c23, anchorId=anc-c23-c587774a, paraIndex=38
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】段落当前书签数: 0
2025-10-21 17:42:04 [http-nio-9999-exec-1] DEBUG c.e.Contract_review.util.DocxUtils - 【书签添加】书签已添加: bookmarkName=anc-c23-c587774a, bookmarkId=724563, 段落现在有1个书签
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【锚点插入】完成: 成功插入=23个, 跳过=0
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.C.service.ContractParseService - 【工作流】锚点插入完成
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.C.service.ContractParseService - 【工作流】开始将修改的文档保存为字节数组
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【文档保存】即将保存文档: 总段落数=44, 总书签数=24, 书签列表: [Para5: anc-c1-304286e3] [Para8: _GoBack] [Para9: anc-c2-9de47575] [Para10: anc-c3-ea3ec6c4] [Para14: anc-c4-81b83145] [Para15: anc-c5-28115872] [Para16: anc-c6-61522cc8] [Para17: anc-c7-b36a73c2] [Para21: anc-c8-291e4a0a] [Para22: anc-c9-3c2638dc] [Para23: anc-c10-884a5461] [Para24: anc-c11-7dc75b7d] [Para25: anc-c12-57dbc9fc] [Para26: anc-c13-3fab89f0] [Para27: anc-c14-c1f1f7e5] [Para28: anc-c15-d0471f05] [Para29: anc-c16-4d20610c] [Para30: anc-c17-2c6d0d52] [Para31: anc-c18-4eeb43d4] [Para33: anc-c19-80d2f88c] [Para34: anc-c20-499e999d] [Para36: anc-c21-9d843cbb] [Para37: anc-c22-5bfe3c7f] [Para38: anc-c23-c587774a] 
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.Contract_review.util.DocxUtils - 【文档保存】文档已保存到字节数组: 文档大小=35108 字节
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.C.service.ContractParseService - 【工作流】文档字节数组生成完成: 大小=35108 字节
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.C.service.ContractParseService - 解析完成并生成带锚点文档: title=技术服务合同（综合测试版）, clauses=23, documentBytes大小=35108
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.C.c.ChatGPTIntegrationController - 已生成带锚点的 DOCX 文档: size=35108 字节
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.C.s.i.ChatGPTWebReviewServiceImpl - 生成ChatGPT网页版提示: contractType=通用合同
2025-10-21 17:42:04 [http-nio-9999-exec-1] INFO  c.e.C.s.i.ChatGPTWebReviewServiceImpl - ChatGPT提示生成完成，长度: 7943
2025-10-21 17:42:05 [http-nio-9999-exec-1] INFO  c.e.C.service.ParseResultCache - 【缓存】Parse 结果已存储: parseResultId=4bcd983a-4d8f-443f-910c-b81050971509, 条款数=23, 文档大小=35108 字节, 文件名=??????_???????.docx
2025-10-21 17:42:05 [http-nio-9999-exec-1] INFO  c.e.C.c.ChatGPTIntegrationController - ChatGPT提示生成成功，已启用锚点精确定位
2025-10-21 17:42:30 [http-nio-9999-exec-2] ERROR c.e.C.c.GlobalExceptionHandler - 未处理的异常: Required request parameter 'chatgptResponse' for method parameter type String is not present
org.springframework.web.bind.MissingServletRequestParameterException: Required request parameter 'chatgptResponse' for method parameter type String is not present
	at org.springframework.web.method.annotation.RequestParamMethodArgumentResolver.handleMissingValueInternal(RequestParamMethodArgumentResolver.java:220)
	at org.springframework.web.method.annotation.RequestParamMethodArgumentResolver.handleMissingValue(RequestParamMethodArgumentResolver.java:196)
	at org.springframework.web.method.annotation.AbstractNamedValueMethodArgumentResolver.resolveArgument(AbstractNamedValueMethodArgumentResolver.java:125)
	at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:122)
	at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:227)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:181)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1776)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:975)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:493)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-10-21 17:43:38 [http-nio-9999-exec-3] INFO  c.e.C.c.ChatGPTIntegrationController - 导入ChatGPT审查结果（XML专用端点）: parseResultId=4bcd983a-4d8f-443f-910c-b81050971509, hasFile=false, strategy=preferAnchor, cleanup=true
2025-10-21 17:43:38 [http-nio-9999-exec-3] INFO  c.e.C.service.ParseResultCache - 【缓存】Parse 结果已检索: parseResultId=4bcd983a-4d8f-443f-910c-b81050971509, 年龄=93 秒, 条款数=23, 文件名=??????_???????.docx
2025-10-21 17:43:38 [http-nio-9999-exec-3] INFO  c.e.C.c.ChatGPTIntegrationController - ? 使用缓存的带锚点文档: parseResultId=4bcd983a-4d8f-443f-910c-b81050971509, 大小=35108 字节, 条款数=23
2025-10-21 17:43:38 [http-nio-9999-exec-3] WARN  c.e.C.s.XmlContractAnnotateService - 审查JSON为空
2025-10-21 17:43:38 [http-nio-9999-exec-3] ERROR c.e.C.c.ChatGPTIntegrationController - 导入ChatGPT审查结果（XML专用）失败
java.lang.IllegalArgumentException: ChatGPT响应JSON格式无效
	at com.example.Contract_review.controller.ChatGPTIntegrationController.importResultXml(ChatGPTIntegrationController.java:275)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1776)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:975)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:493)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-10-21 17:44:14 [http-nio-9999-exec-4] ERROR c.e.C.c.GlobalExceptionHandler - 运行时异常: Failed to convert value of type 'org.springframework.web.multipart.support.StandardMultipartHttpServletRequest$StandardMultipartFile' to required type 'java.lang.String'; Cannot convert value of type 'org.springframework.web.multipart.support.StandardMultipartHttpServletRequest$StandardMultipartFile' to required type 'java.lang.String' for property 'chatgptResponse': no matching editors or conversion strategy found
org.springframework.web.method.annotation.MethodArgumentConversionNotSupportedException: Failed to convert value of type 'org.springframework.web.multipart.support.StandardMultipartHttpServletRequest$StandardMultipartFile' to required type 'java.lang.String'; Cannot convert value of type 'org.springframework.web.multipart.support.StandardMultipartHttpServletRequest$StandardMultipartFile' to required type 'java.lang.String' for property 'chatgptResponse': no matching editors or conversion strategy found
	at org.springframework.web.method.annotation.AbstractNamedValueMethodArgumentResolver.convertIfNecessary(AbstractNamedValueMethodArgumentResolver.java:297)
	at org.springframework.web.method.annotation.AbstractNamedValueMethodArgumentResolver.resolveArgument(AbstractNamedValueMethodArgumentResolver.java:136)
	at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:122)
	at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:227)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:181)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1776)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:975)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:493)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.lang.IllegalStateException: Cannot convert value of type 'org.springframework.web.multipart.support.StandardMultipartHttpServletRequest$StandardMultipartFile' to required type 'java.lang.String' for property 'chatgptResponse': no matching editors or conversion strategy found
	at org.springframework.beans.TypeConverterDelegate.convertIfNecessary(TypeConverterDelegate.java:273)
	at org.springframework.beans.TypeConverterSupport.convertIfNecessary(TypeConverterSupport.java:80)
	at org.springframework.beans.TypeConverterSupport.convertIfNecessary(TypeConverterSupport.java:53)
	at org.springframework.validation.DataBinder.convertIfNecessary(DataBinder.java:867)
	at org.springframework.web.method.annotation.AbstractNamedValueMethodArgumentResolver.convertIfNecessary(AbstractNamedValueMethodArgumentResolver.java:293)
	... 48 common frames omitted
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.c.ChatGPTIntegrationController - 导入ChatGPT审查结果（XML专用端点）: parseResultId=4bcd983a-4d8f-443f-910c-b81050971509, hasFile=false, strategy=preferAnchor, cleanup=true
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.service.ParseResultCache - 【缓存】Parse 结果已检索: parseResultId=4bcd983a-4d8f-443f-910c-b81050971509, 年龄=196 秒, 条款数=23, 文件名=??????_???????.docx
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.c.ChatGPTIntegrationController - ? 使用缓存的带锚点文档: parseResultId=4bcd983a-4d8f-443f-910c-b81050971509, 大小=35108 字节, 条款数=23
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.s.XmlContractAnnotateService - JSON验证通过，包含3个问题
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.s.XmlContractAnnotateService - JSON验证通过，包含3个问题
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.s.XmlContractAnnotateService - 开始XML方式批注处理: filename=contract.docx, anchorStrategy=preferAnchor, cleanupAnchors=true
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.s.XmlContractAnnotateService - 接收到审查JSON数据: {
  "issues": [
    {
      "clauseId": "c1",
      "anchorId": "anc-c1-304286e3",
      "severity": "HIGH",
      "category": "合同目的",
      "finding": "合同目的表述不够具体，缺少量化指标",
      "suggestion": "建议补充具体的合作目标、时间表和关键成果指标（KPI）"
    },
    {
      "clauseId": "c3",
      "anchorId": "anc-c3-ea3ec6c4",
      "severity": "MEDIUM",
      "category": "交付物定义",
      "finding": "交付物验收标准不明确，缺少具体的质量要求",
      "suggestion": "应补充详细的验收标准，包括功能完整性、性能指标等"
    },
    {
      "clauseId": "c7",
      "anchorId": "anc-c7-b36a73c2",
      "severity": "HIGH",
      "category": "付款条款",
      "finding": "付款条件与交付阶段的对应关系不明确",
      "suggestion": "建议补充详细的验收流程和支付触发条件"
    }
  ]
}
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.s.XmlContractAnnotateService - JSON验证通过，包含3个问题
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.s.XmlContractAnnotateService - JSON解析成功, ReviewRequest对象: ReviewRequest(issues=[ReviewIssue(anchorId=anc-c1-304286e3, clauseId=c1, severity=HIGH, category=合同目的, finding=合同目的表述不够具体，缺少量化指标, suggestion=建议补充具体的合作目标、时间表和关键成果指标（KPI）, targetText=null, matchPattern=EXACT, matchIndex=1), ReviewIssue(anchorId=anc-c3-ea3ec6c4, clauseId=c3, severity=MEDIUM, category=交付物定义, finding=交付物验收标准不明确，缺少具体的质量要求, suggestion=应补充详细的验收标准，包括功能完整性、性能指标等, targetText=null, matchPattern=EXACT, matchIndex=1), ReviewIssue(anchorId=anc-c7-b36a73c2, clauseId=c7, severity=HIGH, category=付款条款, finding=付款条件与交付阶段的对应关系不明确, suggestion=建议补充详细的验收流程和支付触发条件, targetText=null, matchPattern=EXACT, matchIndex=1)])
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.s.XmlContractAnnotateService - 获取到issues列表: 数量=3
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.s.XmlContractAnnotateService - [Issue 1] clauseId=c1, anchorId=? anc-c1-304286e3, targetText存在=false, 其他字段={severity=HIGH, category=合同目的, finding长度=17}
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.s.XmlContractAnnotateService - [Issue 2] clauseId=c3, anchorId=? anc-c3-ea3ec6c4, targetText存在=false, 其他字段={severity=MEDIUM, category=交付物定义, finding长度=20}
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.s.XmlContractAnnotateService - [Issue 3] clauseId=c7, anchorId=? anc-c7-b36a73c2, targetText存在=false, 其他字段={severity=HIGH, category=付款条款, finding长度=17}
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.s.XmlContractAnnotateService - 读取原始文档，大小: 35108 字节
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.util.WordXmlCommentProcessor - 开始XML方式添加批注：issues数量=3, 策略=preferAnchor, 清理锚点=true
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor - 递归查找段落完成：共找到 60 个段落
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.util.WordXmlCommentProcessor - 开始查找目标段落：clauseId=c1, anchorId=anc-c1-304286e3, 策略=preferAnchor, 总段落数=60 (包含表格内段落)
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor - 使用 preferAnchor 策略（默认）：优先anchorId，失败则用文本匹配
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor - 开始按anchorId查找段落：anchorId=anc-c1-304286e3, 总段落数=60
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -   [段落5] 发现 1 个书签
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -     书签名称: anc-c1-304286e3
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.util.WordXmlCommentProcessor - ? 通过锚点找到目标段落：anchorId=anc-c1-304286e3, 段落索引=5
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.util.WordXmlCommentProcessor - ? 锚点查找成功
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor - 在段落中插入批注标记（段落级别）：commentId=1
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor - 在comments.xml中添加批注内容：commentId=1, 内容长度=62
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor - 成功添加批注：commentId=1, clauseId=c1, 方式=段落
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor - 递归查找段落完成：共找到 60 个段落
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.util.WordXmlCommentProcessor - 开始查找目标段落：clauseId=c3, anchorId=anc-c3-ea3ec6c4, 策略=preferAnchor, 总段落数=60 (包含表格内段落)
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor - 使用 preferAnchor 策略（默认）：优先anchorId，失败则用文本匹配
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor - 开始按anchorId查找段落：anchorId=anc-c3-ea3ec6c4, 总段落数=60
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -   [段落5] 发现 1 个书签
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -     书签名称: anc-c1-304286e3
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -   [段落8] 发现 1 个书签
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -     书签名称: _GoBack
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -   [段落9] 发现 1 个书签
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -     书签名称: anc-c2-9de47575
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -   [段落10] 发现 1 个书签
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -     书签名称: anc-c3-ea3ec6c4
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.util.WordXmlCommentProcessor - ? 通过锚点找到目标段落：anchorId=anc-c3-ea3ec6c4, 段落索引=10
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.util.WordXmlCommentProcessor - ? 锚点查找成功
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor - 在段落中插入批注标记（段落级别）：commentId=2
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor - 在comments.xml中添加批注内容：commentId=2, 内容长度=63
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor - 成功添加批注：commentId=2, clauseId=c3, 方式=段落
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor - 递归查找段落完成：共找到 60 个段落
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.util.WordXmlCommentProcessor - 开始查找目标段落：clauseId=c7, anchorId=anc-c7-b36a73c2, 策略=preferAnchor, 总段落数=60 (包含表格内段落)
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor - 使用 preferAnchor 策略（默认）：优先anchorId，失败则用文本匹配
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor - 开始按anchorId查找段落：anchorId=anc-c7-b36a73c2, 总段落数=60
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -   [段落5] 发现 1 个书签
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -     书签名称: anc-c1-304286e3
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -   [段落8] 发现 1 个书签
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -     书签名称: _GoBack
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -   [段落9] 发现 1 个书签
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -     书签名称: anc-c2-9de47575
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -   [段落10] 发现 1 个书签
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -     书签名称: anc-c3-ea3ec6c4
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -   [段落14] 发现 1 个书签
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -     书签名称: anc-c4-81b83145
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -   [段落31] 发现 1 个书签
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -     书签名称: anc-c5-28115872
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -   [段落32] 发现 1 个书签
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -     书签名称: anc-c6-61522cc8
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -   [段落33] 发现 1 个书签
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor -     书签名称: anc-c7-b36a73c2
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.util.WordXmlCommentProcessor - ? 通过锚点找到目标段落：anchorId=anc-c7-b36a73c2, 段落索引=33
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.util.WordXmlCommentProcessor - ? 锚点查找成功
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor - 在段落中插入批注标记（段落级别）：commentId=3
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor - 在comments.xml中添加批注内容：commentId=3, 内容长度=53
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor - 成功添加批注：commentId=3, clauseId=c7, 方式=段落
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor - 递归查找段落完成：共找到 60 个段落
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor - 开始清理锚点：总段落数=60 (包含表格内段落)
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.util.WordXmlCommentProcessor - 清理锚点完成：共清理 23 个锚点
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.util.WordXmlCommentProcessor - 已清理文档中的锚点标记
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor - document.xml保存完成，大小: 11798 字节
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor - comments.xml保存完成，大小: 2820 字节
2025-10-21 17:45:21 [http-nio-9999-exec-5] DEBUG c.e.C.util.WordXmlCommentProcessor - comments关系已存在，跳过添加
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.util.WordXmlCommentProcessor - XML批注处理完成：成功添加3个批注
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.s.XmlContractAnnotateService - XML批注处理完成，输出文档大小: 35484 字节
2025-10-21 17:45:21 [http-nio-9999-exec-5] INFO  c.e.C.c.ChatGPTIntegrationController - ChatGPT审查结果导入成功（XML专用）: 文档来源=缓存的带锚点文档, 总问题3个
