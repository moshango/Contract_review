# 03_诊断和分析

## 🔬 问题诊断和根因分析

本目录包含所有问题的诊断报告、根因分析和故障排查指南。共 **12 份文档**。

### 📄 文档分类

#### ParseResultId 诊断（2份）
1. **01_ParseResultId诊断报告.md** - ParseResultId 问题的专项诊断分析
2. **02_ParseResultId诊断指南.md** - ParseResultId 问题的排查步骤和指南

#### 批注相关诊断（2份）
3. **03_批注插入问题诊断.md** - 批注无法正确插入问题的诊断
4. **DIAGNOSIS_ANNOTATION_INSERTION_ISSUE.md** - 批注插入问题的详细诊断

#### 当事人提取诊断（4份）
5. **04_当事人信息提取诊断.md** - 当事人信息提取失败问题的诊断
6. **05_当事人提取优化.md** - 当事人提取优化方案
7. **06_当事人信息提取解决方案.md** - 当事人信息提取的完整解决方案
8. **07_当事人提取最终解决方案.md** - 当事人提取的最终方案

#### 其他诊断（4份）
9. **08_关键词匹配问题诊断.md** - 关键词匹配问题的诊断
10. **JSON_FORMAT_ANALYSIS.md** - JSON 格式问题的分析
11. **ROOT_CAUSE_FINAL.md** - 根本原因的最终结论
12. **其他诊断文件** - 包含各种技术分析

---

## 🎯 按问题类型快速查找

### ParseResultId 问题
**症状**：
- 解析结果中 ParseResultId 为 null 或空
- 规则审查时无法获取 ParseResultId
- 审查流程中断

**查看文档**：
1. 快速诊断 → [`02_ParseResultId诊断指南.md`](02_ParseResultId诊断指南.md)
2. 详细分析 → [`01_ParseResultId诊断报告.md`](01_ParseResultId诊断报告.md)

### 批注插入问题
**症状**：
- 调用 `/annotate` 后批注未出现在文档中
- 批注定位错误
- 批注内容格式不对

**查看文档**：
1. 快速诊断 → [`03_批注插入问题诊断.md`](03_批注插入问题诊断.md)
2. 详细分析 → [`DIAGNOSIS_ANNOTATION_INSERTION_ISSUE.md`](DIAGNOSIS_ANNOTATION_INSERTION_ISSUE.md)

### 当事人信息提取问题
**症状**：
- 无法正确识别合同中的当事人
- 当事人信息不完整
- 当事人提取出错

**查看文档**：[`04_当事人信息提取诊断.md`](04_当事人信息提取诊断.md)

### JSON 格式问题
**症状**：
- API 返回的 JSON 格式错误
- 字段缺失或类型不对

**查看文档**：[`JSON_FORMAT_ANALYSIS.md`](JSON_FORMAT_ANALYSIS.md)

---

## 🔍 诊断方法论

### 第一步：识别问题
1. 查看错误日志，确定问题类型
2. 在本目录中查找对应的问题文档

### 第二步：快速诊断
- 按照诊断指南执行排查步骤
- 记录现象和日志

### 第三步：深度分析
- 如果快速诊断无法解决，查看详细分析文档
- 参考"根本原因"部分

### 第四步：解决问题
- 根据"解决方案"部分进行修复
- 参考 [`02_实现和修复总结/`](../02_实现和修复总结/) 了解具体实现

### 第五步：验证
- 参考 [`04_测试和验证/`](../04_测试和验证/) 进行测试验证

---

## 🚨 常见问题快速解决

| 问题 | 快速解决方案 |
|-----|-----------|
| ParseResultId 为 null | 检查解析时是否传递了 result 参数 |
| 批注无法插入 | 检查锚点是否正确生成 |
| JSON 格式错误 | 查看 JSON_FORMAT_ANALYSIS.md |

---

## 📊 问题统计

| 问题类型 | 数量 | 严重程度 | 状态 |
|---------|-----|--------|------|
| ParseResultId 相关 | 3+ | 🔴 高 | ✅ 已解决 |
| 批注插入相关 | 2+ | 🔴 高 | ✅ 已解决 |
| 当事人提取相关 | 1+ | 🟡 中 | ✅ 已解决 |
| 其他格式问题 | 2+ | 🟡 中 | ✅ 已解决 |

---

## 📚 相关文档

- 修复方案详情 → [`02_实现和修复总结/`](../02_实现和修复总结/)
- 测试验证步骤 → [`04_测试和验证/`](../04_测试和验证/)
- 快速参考 → [`05_快速参考/05_解决方案总结.md`](../05_快速参考/05_解决方案总结.md)

---

## 💡 诊断技巧

1. **启用调试日志**：在 `application.properties` 中设置 `logging.level.root=DEBUG`
2. **使用测试客户端**：使用 Postman 或 curl 测试 API
3. **查看系统日志**：检查 `logs/` 目录中的日志文件
4. **数据库检查**：如有缓存问题，检查相关表

---

**返回**：[📚 文档中心主页](../README.md)
