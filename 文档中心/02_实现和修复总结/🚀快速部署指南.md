# 🚀 快速部署指南 (5分钟版)

**目的**: 将更新的JAR部署到生产环境

---

## 第一步：准备工作 (1分钟)

```bash
# 1. 备份旧文件
cp Contract_review-0.0.1-SNAPSHOT.jar Contract_review-0.0.1-SNAPSHOT.jar.backup

# 2. 停止当前服务 (可选，取决于部署方式)
# - 如果使用systemd: systemctl stop contract-review
# - 如果使用docker: docker stop contract_review
# - 如果手动运行: 按 Ctrl+C
```

---

## 第二步：部署新文件 (2分钟)

```bash
# 复制新的JAR文件
cp /path/to/new/Contract_review-0.0.1-SNAPSHOT.jar ./

# 启动服务
java -jar Contract_review-0.0.1-SNAPSHOT.jar
```

---

## 第三步：验证服务 (1分钟)

```bash
# 检查API健康状态
curl http://localhost:8080/api/unified/review/health

# 预期响应:
# {"status":"UP","message":"Service is running"}
```

---

## 第四步：清除浏览器缓存 (1分钟)

**重要**: JavaScript代码已修改，必须清除缓存！

### Chrome
1. 按 `Ctrl+Shift+Delete`
2. 选择"全部时间"
3. 勾选"Cookie和其他网站数据"、"缓存的图片和文件"
4. 点击"清除数据"

### Firefox
1. 按 `Ctrl+Shift+Delete`
2. 选择"全部"
3. 点击"清除现在"

### Safari (Mac)
1. 按 `⌘+Option+E`

### Edge
1. 按 `Ctrl+Shift+Delete`

---

## ✅ 快速验证清单

部署后立即检查以下项目：

- [ ] 访问 http://localhost:8080 - 页面加载正常
- [ ] 上传合同文件 - 文件上传成功
- [ ] 点击"开始规则审查" - 页面不报错
- [ ] 选择审查立场 - 继续进行
- [ ] 查看结果 - 条款列表显示正常，**无TypeError**

---

## 🆘 遇到问题?

### 问题1: 仍然看到TypeError

**原因**: 浏览器缓存未清除
**解决**: 再次清除缓存，或使用无痕窗口重新加载

### 问题2: 条款列表为空

**原因**: 后端没有返回条款数据
**解决**: 检查后端日志，确认审查逻辑正确执行

### 问题3: API 404错误

**原因**: 服务未正确启动
**解决**: 检查Java进程是否运行

---

## 📊 关键变更说明

### 新增API
```
POST /api/unified/review
```

**参数**:
- file: 上传的文件
- contractType: 合同类型
- party: 审查立场
- reviewMode: 审查模式 (rules/ai/full)
- aiProvider: AI提供商 (qwen/...)

**返回**: JSON格式的审查结果

### 修复内容
- ✅ 规则审查现在支持字段兼容性
- ✅ TypeError已彻底修复
- ✅ 防御性编程已实现
- ✅ 代码重复度已消除

---

## 📝 查看详细文档

1. **完整总结**: `2025-10-27会话完整总结-最终版.md`
2. **检查清单**: `部署前最终检查清单.md`
3. **API参考**: `代码整合快速参考.md`
4. **修复详情**: `规则审查TypeError彻底修复.md`

---

## ⏱️ 预期耗时

| 步骤 | 耗时 |
|------|------|
| 备份旧文件 | 30秒 |
| 部署新文件 | 1分钟 |
| 启动服务 | 30秒 |
| 验证API | 30秒 |
| 清除缓存 | 1分钟 |
| 功能测试 | 2分钟 |
| **总计** | **~5分钟** |

---

**部署完成后，系统应正常工作！** ✅

---
