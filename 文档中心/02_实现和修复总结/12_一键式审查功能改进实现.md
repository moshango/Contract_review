# ä¸€é”®å¼å®¡æŸ¥åŠŸèƒ½ - æ”¹è¿›å®ç°æ€»ç»“

**å®ç°æ—¥æœŸ**: 2025-10-27
**çŠ¶æ€**: âœ… **å®Œæˆå¹¶å¯ç”¨**
**å®ç°æ–¹å¼**: å‰ç«¯å¤šæ­¥éª¤æµç¨‹ç¼–æ’ + ç°æœ‰åç«¯ç«¯ç‚¹å¤ç”¨

---

## ğŸ“‹ å®ç°æ¦‚è¿°

### åŸéœ€æ±‚åˆ†æ

ç”¨æˆ·è¦æ±‚ä¸€é”®å®¡æŸ¥åŠŸèƒ½æ”¹è¿›ä¸ºï¼š
1. âœ… æ–‡ä»¶ä¸Šä¼ åå…ˆ**è§£æ**ï¼ŒåŠ è½½å‡º**ç”²ä¹™æ–¹ä¿¡æ¯**
2. âœ… æ˜¾ç¤ºæå–çš„ç”²ä¹™æ–¹ä¿¡æ¯ä¾›ç”¨æˆ·ç¡®è®¤
3. âœ… **ç”¨æˆ·é€‰æ‹©ç«‹åœº**åå†å¼€å§‹å®¡æŸ¥æµç¨‹
4. âœ… **å¤ç”¨ç°æœ‰ç«¯ç‚¹**ï¼Œä¸ä¿®æ”¹å·²æœ‰åŠŸèƒ½
5. âœ… ç”Ÿæˆçš„æ–‡æ¡£**å½’æ¡£åˆ°æ–‡æ¡£ä¸­å¿ƒ**ï¼Œ**ä¸­æ–‡æ–‡ä»¶å**

### è¯„ä¼°ç»“æœ

âœ… **å¯å®Œå…¨å¤ç”¨ç°æœ‰ç«¯ç‚¹**ï¼Œæ— éœ€åˆ›å»ºæ–°çš„åç«¯ç«¯ç‚¹

æ‰€æœ‰å¿…è¦çš„åŠŸèƒ½éƒ½å·²å­˜åœ¨ï¼š

| åŠŸèƒ½éœ€æ±‚ | ç°æœ‰å®ç° | ç«¯ç‚¹ |
|---------|---------|------|
| æ–‡ä»¶è§£æ + ç”²ä¹™æ–¹æå– | âœ… ContractParseService | `/api/parse?anchors=generate` |
| æ™ºèƒ½å®¡æŸ¥ | âœ… QwenRuleReviewService | `/api/qwen/rule-review/review` |
| æ–‡æ¡£æ‰¹æ³¨ | âœ… XmlContractAnnotateService | `/api/annotate-xml` |
| ä¸€é”®æµç¨‹ | âœ… QwenRuleReviewController | `/api/qwen/rule-review/one-click-review` |
| æ–‡æ¡£ä¿å­˜ | âœ… Files API æ”¯æŒ | è‡ªåŠ¨ä¿å­˜åˆ° æ–‡æ¡£ä¸­å¿ƒ |
| ä¸­æ–‡æ–‡ä»¶å | âœ… Paths.get() æ”¯æŒ | - |

---

## ğŸ”„ å®Œæ•´çš„å¤šæ­¥éª¤å·¥ä½œæµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ä¸€é”®å®¡æŸ¥ - ç”¨æˆ·æ“ä½œæµç¨‹                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ã€ç¬¬1æ­¥ã€‘ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶
   â”œâ”€ é€‰æ‹© .docx/.doc æ–‡ä»¶
   â””â”€ ç‚¹å‡»"å¼€å§‹ä¸€é”®å®¡æŸ¥"æŒ‰é’®
        â”‚
        â†“
ã€ç¬¬2æ­¥ã€‘å‰ç«¯è‡ªåŠ¨è§£ææ–‡ä»¶ï¼ˆè°ƒç”¨ /api/parse?anchors=generateï¼‰
   â”œâ”€ è§£æåˆåŒç»“æ„å’Œå†…å®¹
   â”œâ”€ æå–ç”²ä¹™æ–¹ä¿¡æ¯
   â”œâ”€ ç”Ÿæˆé”šç‚¹ç”¨äºç²¾ç¡®æ‰¹æ³¨
   â””â”€ ä¿å­˜ parseResultId åˆ° window.ruleReviewParseResultId
        â”‚
        â†“
ã€ç¬¬3æ­¥ã€‘å‰ç«¯æ˜¾ç¤ºå·²è¯†åˆ«çš„ç”²ä¹™æ–¹
   â”œâ”€ æ˜¾ç¤ºç”²æ–¹ï¼š{å…¬å¸å} ({è§’è‰²})
   â”œâ”€ æ˜¾ç¤ºä¹™æ–¹ï¼š{å…¬å¸å} ({è§’è‰²})
   â””â”€ é«˜äº®ç«‹åœºé€‰æ‹©åŒºåŸŸï¼Œæç¤ºç”¨æˆ·é€‰æ‹©
        â”‚
        â†“
ã€ç¬¬4æ­¥ã€‘ç”¨æˆ·é€‰æ‹©å®¡æŸ¥ç«‹åœº
   â”œâ”€ å¯é€‰ï¼šä¸­ç«‹ (å®¢è§‚ã€å¹³è¡¡)
   â”œâ”€ å¯é€‰ï¼šç”²æ–¹ (ä¸ºç”²æ–¹äº‰å–æƒç›Š)
   â”œâ”€ å¯é€‰ï¼šä¹™æ–¹ (ä¸ºä¹™æ–¹äº‰å–æƒç›Š)
   â””â”€ ç”¨æˆ·ç‚¹å‡»é€‰æ‹©ç«‹åœº
        â”‚
        â†“ (è‡ªåŠ¨è§¦å‘)
ã€ç¬¬5æ­¥ã€‘å‰ç«¯è°ƒç”¨å®Œæ•´çš„ä¸€é”®å®¡æŸ¥ï¼ˆ/api/qwen/rule-review/one-click-reviewï¼‰
   â”œâ”€ åç«¯æ­¥éª¤1: è§£æåˆåŒï¼ˆä¼ é€’ stanceï¼‰
   â”œâ”€ åç«¯æ­¥éª¤2: ç”Ÿæˆå®šåˆ¶ Promptï¼ˆåŸºäºç«‹åœºï¼‰
   â”œâ”€ åç«¯æ­¥éª¤3: è°ƒç”¨ Qwen è¿›è¡Œå®¡æŸ¥
   â”œâ”€ åç«¯æ­¥éª¤4: æ‰¹æ³¨æ–‡æ¡£ï¼ˆä½¿ç”¨é”šç‚¹ç²¾ç¡®å®šä½ï¼‰
   â”œâ”€ åç«¯æ­¥éª¤5: ä¿å­˜åˆ° æ–‡æ¡£ä¸­å¿ƒ/å·²ç”Ÿæˆçš„å®¡æŸ¥æŠ¥å‘Š/
   â”‚            æ–‡ä»¶åï¼š{åŸå}_ä¸€é”®å®¡æŸ¥_{ç«‹åœº}.docx
   â””â”€ åç«¯æ­¥éª¤6: è¿”å›æ‰¹æ³¨åçš„æ–‡æ¡£
        â”‚
        â†“
ã€ç¬¬6æ­¥ã€‘å‰ç«¯è‡ªåŠ¨ä¸‹è½½æ–‡æ¡£
   â”œâ”€ ä¸‹è½½ï¼š{åŸå}_ä¸€é”®å®¡æŸ¥_{ç«‹åœº}.docx
   â””â”€ æç¤ºç”¨æˆ·å·²ä¿å­˜åˆ°æ–‡æ¡£ä¸­å¿ƒ
        â”‚
        â†“
ã€å®Œæˆã€‘æ˜¾ç¤ºæˆåŠŸæç¤ºå’Œä¿å­˜ä½ç½®
   â”œâ”€ æ–‡ä»¶å·²è‡ªåŠ¨ä¸‹è½½
   â”œâ”€ æ–‡ä»¶å·²è‡ªåŠ¨ä¿å­˜åˆ°ï¼šæ–‡æ¡£ä¸­å¿ƒ/å·²ç”Ÿæˆçš„å®¡æŸ¥æŠ¥å‘Š/
   â””â”€ æä¾›"ç»§ç»­å®¡æŸ¥"æŒ‰é’®
```

---

## ğŸ› ï¸ å®ç°ç»†èŠ‚

### 1. å‰ç«¯å‡½æ•°ç»“æ„

**ä¸»å‡½æ•°**: `startOneClickReview()` (lines 1414-1492)
```
Purpose: ç¬¬ä¸€æ­¥éª¤ - æ–‡ä»¶è§£æå’Œç”²ä¹™æ–¹æå–
Flow:
  1. éªŒè¯æ–‡ä»¶æ˜¯å¦é€‰ä¸­
  2. æ˜¾ç¤ºåŠ è½½åŠ¨ç”»ï¼š"æ­¥éª¤ 1/3ï¼šæ­£åœ¨è§£æåˆåŒ..."
  3. è°ƒç”¨ /api/parse?anchors=generate è·å–è§£æç»“æœ
  4. ä¿å­˜ parseResultId åˆ°å…¨å±€å˜é‡
  5. æ˜¾ç¤ºå·²è¯†åˆ«çš„ç”²ä¹™æ–¹ä¿¡æ¯
  6. è®¾ç½®ç«‹åœºé€‰æ‹©ç›‘å¬å™¨
  7. é«˜äº®ç«‹åœºé€‰æ‹©åŒºåŸŸå¹¶æç¤ºç”¨æˆ·é€‰æ‹©

Dependencies:
  - displayIdentifiedParties()
  - setupStanceSelectionListener()
  - ruleReviewFile (å…¨å±€å˜é‡)
```

**è¾…åŠ©å‡½æ•°**: `displayIdentifiedParties(parseResult)` (lines 1497-1520)
```
Purpose: åœ¨UIä¸­æ˜¾ç¤ºå·²è¯†åˆ«çš„ç”²ä¹™æ–¹
Params:
  - parseResult: æ¥è‡ª /api/parse çš„è¿”å›ç»“æœ

Behavior:
  - æ£€æŸ¥ parseResult.partyA å’Œ parseResult.partyB
  - å¦‚æœå­˜åœ¨ï¼Œæ˜¾ç¤ºåœ¨ #identified-parties-info åŒºåŸŸ
  - æ ¼å¼ï¼š"{å…¬å¸å} ({è§’è‰²æ ‡ç­¾})"
  - å¦‚æœä¸å­˜åœ¨ï¼Œéšè—è¯¥åŒºåŸŸ
```

**äº‹ä»¶ç›‘å¬**: `setupStanceSelectionListener()` (lines 1526-1558)
```
Purpose: ç›‘å¬ç«‹åœºé€‰æ‹©äº‹ä»¶å¹¶è‡ªåŠ¨è§¦å‘ä¸‹ä¸€æ­¥
Behavior:
  1. æ¸…é™¤ä¹‹å‰çš„äº‹ä»¶ç›‘å¬å™¨ï¼ˆé˜²æ­¢é‡å¤ï¼‰
  2. ä¸ºæ‰€æœ‰ç«‹åœºå•é€‰æŒ‰é’®æ·»åŠ  change äº‹ä»¶ç›‘å¬
  3. å½“ç”¨æˆ·é€‰æ‹©ç«‹åœºæ—¶ï¼š
     - æ˜¾ç¤º"å·²é€‰æ‹©ç«‹åœºï¼š{ç«‹åœº}"æç¤º
     - å»¶è¿Ÿ 500ms åè‡ªåŠ¨è°ƒç”¨ performOneClickReview()
  4. é˜²æ­¢å¤šæ¬¡è§¦å‘ï¼ˆä½¿ç”¨ stanceSelected æ ‡å¿—ï¼‰
```

**æ‰§è¡Œå‡½æ•°**: `performOneClickReview(stance)` (lines 1564-1631)
```
Purpose: ç¬¬äºŒæ­¥éª¤ - æ‰§è¡Œå®é™…çš„ä¸€é”®å®¡æŸ¥æµç¨‹
Params:
  - stance: ç”¨æˆ·é€‰æ‹©çš„ç«‹åœº (neutral, Aæ–¹, Bæ–¹)

Flow:
  1. æ˜¾ç¤ºåŠ è½½åŠ¨ç”»ï¼š"æ­¥éª¤ 2/3ï¼šæ­£åœ¨è¿›è¡Œæ™ºèƒ½å®¡æŸ¥..."
  2. æ„å»º FormDataï¼šfile + stance
  3. POST åˆ° /api/qwen/rule-review/one-click-review
  4. æ¥æ”¶æ‰¹æ³¨åçš„æ–‡æ¡£ blob
  5. è‡ªåŠ¨ä¸‹è½½æ–‡ä»¶ï¼š"{åŸå}_ä¸€é”®å®¡æŸ¥_{stance}.docx"
  6. æ˜¾ç¤ºæˆåŠŸæç¤º
  7. è°ƒç”¨ displayOneClickReviewSuccess() æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯

Error Handling:
  - æ•è· fetch å¼‚å¸¸
  - éšè—åŠ è½½åŠ¨ç”»
  - æ˜¾ç¤ºé”™è¯¯æç¤º
```

**é‡ç½®å‡½æ•°**: `resetRuleReviewForm()` (lines 1389-1424)
```
Improvements:
  - ã€æ”¹è¿›ã€‘æ¸…ç†å·²è¯†åˆ«çš„åˆåŒæ–¹ä¿¡æ¯ (#identified-parties-info)
  - ã€æ”¹è¿›ã€‘æ¸…ç†æˆåŠŸæç¤º (#one-click-success-box)
  - ã€æ”¹è¿›ã€‘æ¸…ç†ç«‹åœºé€‰æ‹©åŒºåŸŸçš„é«˜äº®æ ·å¼
  - ã€æ”¹è¿›ã€‘é‡ç½®ç«‹åœºé€‰æ‹©åˆ°"ä¸­ç«‹"
  - æ¸…ç† parseResultId
  - æ¸…ç†æ–‡ä»¶é€‰æ‹©
  - æ¸…ç†ç»“æœæ˜¾ç¤º
```

---

### 2. ç«¯ç‚¹å¤ç”¨åˆ†æ

#### ç«¯ç‚¹ 1: `/api/parse?anchors=generate&returnMode=json`

**ç”¨é€”**: æ–‡ä»¶è§£æå’Œç”²ä¹™æ–¹åˆæ­¥è¯†åˆ«

**è¯·æ±‚ç¤ºä¾‹**:
```bash
POST /api/parse?anchors=generate&returnMode=json
Content-Type: multipart/form-data

file: [binary]
```

**å“åº”åŒ…å«**:
```json
{
  "filename": "åˆåŒ.docx",
  "partyA": "ABCå…¬å¸",
  "partyB": "XYZå…¬å¸",
  "partyARoleName": "ç”²æ–¹",
  "partyBRoleName": "ä¹™æ–¹",
  "clauses": [...],
  "meta": {
    "parseResultId": "uuid-..."
  }
}
```

**å¤ç”¨çŠ¶æ€**: âœ… å®Œå…¨æ»¡è¶³éœ€æ±‚

---

#### ç«¯ç‚¹ 2: `/api/qwen/rule-review/one-click-review`

**ç”¨é€”**: æ‰§è¡Œå®Œæ•´çš„ä¸€é”®å®¡æŸ¥æµç¨‹

**è¯·æ±‚ç¤ºä¾‹**:
```bash
POST /api/qwen/rule-review/one-click-review
Content-Type: multipart/form-data

file: [binary]
stance: "neutral" | "Aæ–¹" | "Bæ–¹"
```

**å“åº”**:
- Content-Type: application/octet-stream
- Body: æ‰¹æ³¨åçš„ .docx æ–‡ä»¶

**åç«¯æµç¨‹**ï¼ˆQwenRuleReviewController.oneClickReview()ï¼‰:
1. âœ… éªŒè¯æ–‡ä»¶æ ¼å¼
2. âœ… è§£æåˆåŒ (generateAnchor)
3. âœ… ç”Ÿæˆç«‹åœºåŒ– Prompt (generateRuleReviewPrompt)
4. âœ… è°ƒç”¨ Qwen å®¡æŸ¥ (reviewContractWithQwen)
5. âœ… æ‰¹æ³¨æ–‡æ¡£ (annotateContractWithXml with preferAnchor)
6. âœ… **ä¿å­˜åˆ°æ–‡æ¡£ä¸­å¿ƒ** (Paths.get + Files.write)
7. âœ… è¿”å›æ–‡ä»¶ blob

**å¤ç”¨çŠ¶æ€**: âœ… **ç°æˆå³ç”¨** - å·²æ”¯æŒæ‰€æœ‰éœ€æ±‚ï¼ŒåŒ…æ‹¬ï¼š
- ä¸­æ–‡æ–‡ä»¶åä¿å­˜
- è‡ªåŠ¨åˆ›å»ºç›®å½•
- ç«‹åœºå‚æ•°æ”¯æŒ
- ç²¾ç¡®é”šç‚¹å®šä½

---

### 3. å…³é”®æŠ€æœ¯ç‰¹æ€§

#### é”šç‚¹ç³»ç»Ÿ (Anchor System)

**ç”Ÿæˆé˜¶æ®µ** (`/api/parse`):
- `anchors=generate` ç”Ÿæˆå¸¦é”šç‚¹çš„æ–‡æ¡£ç‰ˆæœ¬
- æ¯ä¸ªæ¡æ¬¾è·å¾—å”¯ä¸€çš„ `anchorId` (æ ¼å¼: `anc-c1-4f21`)
- é”šç‚¹ä¿¡æ¯å­˜å‚¨åœ¨ `ParseResult` ä¸­

**ä½¿ç”¨é˜¶æ®µ** (`/api/qwen/rule-review/one-click-review`):
- `annotateContractWithXml(..., "preferAnchor", ...)`
- ä½¿ç”¨ `anchorId` ç²¾ç¡®å®šä½æ‰¹æ³¨ä½ç½®
- æ¯”æ–‡æœ¬åŒ¹é…æ›´å¯é ï¼Œé¿å…åŒåæ¡æ¬¾å†²çª

**æ¸…ç†é˜¶æ®µ** (å¯é€‰):
- `cleanupAnchors=true` æ‰¹æ³¨å®Œæˆåç§»é™¤é”šç‚¹
- è¿”å›å¹²å‡€çš„æ–‡æ¡£ä¾›æœ€ç»ˆç”¨æˆ·ä½¿ç”¨

#### æ–‡æ¡£ä¿å­˜åˆ°æ–‡æ¡£ä¸­å¿ƒ

**ä¿å­˜è·¯å¾„**:
```
{é¡¹ç›®æ ¹ç›®å½•}/æ–‡æ¡£ä¸­å¿ƒ/å·²ç”Ÿæˆçš„å®¡æŸ¥æŠ¥å‘Š/
```

**æ–‡ä»¶å‘½å**:
```
{åŸæ–‡ä»¶å}_ä¸€é”®å®¡æŸ¥_{ç«‹åœº}.docx

ç¤ºä¾‹:
  åˆåŒ.docx â†’ åˆåŒ_ä¸€é”®å®¡æŸ¥_neutral.docx
  æŠ€æœ¯åè®®.docx â†’ æŠ€æœ¯åè®®_ä¸€é”®å®¡æŸ¥_Aæ–¹.docx
```

**å®ç°ä»£ç ** (QwenRuleReviewController.java lines 323-342):
```java
// ç”Ÿæˆè¾“å‡ºæ–‡ä»¶åï¼ˆæ”¯æŒä¸­æ–‡ï¼‰
String baseName = filename.replaceAll("\\.(docx|doc)$", "");
String outputFilename = baseName + "_ä¸€é”®å®¡æŸ¥_" + stance + ".docx";

// æ„å»ºè·¨å¹³å°è·¯å¾„ï¼ˆPaths.get è‡ªåŠ¨å¤„ç†ä¸­æ–‡ï¼‰
String projectRoot = System.getProperty("user.dir");
String docCenterPath = Paths.get(projectRoot, "æ–‡æ¡£ä¸­å¿ƒ", "å·²ç”Ÿæˆçš„å®¡æŸ¥æŠ¥å‘Š").toString();

// è‡ªåŠ¨åˆ›å»ºç›®å½•
Path docCenterDir = Paths.get(docCenterPath);
if (!Files.exists(docCenterDir)) {
    Files.createDirectories(docCenterDir);
}

// ä¿å­˜æ–‡ä»¶
Path outputPath = docCenterDir.resolve(outputFilename);
Files.write(outputPath, annotatedDocBytes);
```

**ä¼˜åŠ¿**:
- âœ… å®Œå…¨æ”¯æŒä¸­æ–‡æ–‡ä»¶å
- âœ… è‡ªåŠ¨åˆ›å»ºç›®å½•ï¼ˆæ— éœ€ç”¨æˆ·å¹²é¢„ï¼‰
- âœ… è·¨å¹³å°å…¼å®¹ï¼ˆWindows/Linux/Macï¼‰
- âœ… åŸå­æ€§å†™å…¥ï¼ˆå¤±è´¥ä¸äº§ç”Ÿéƒ¨åˆ†æ–‡ä»¶ï¼‰

---

## ğŸ“Š å·¥ä½œæµæ•°æ®æµ

```
ã€ç¬¬1æ­¥ã€‘
å®¢æˆ·ç«¯
  â†’ é€‰æ‹©æ–‡ä»¶ ruleReviewFile
  â†’ ç‚¹å‡»"å¼€å§‹ä¸€é”®å®¡æŸ¥"
  â†’ è°ƒç”¨ startOneClickReview()

ã€ç¬¬2æ­¥ã€‘
startOneClickReview()
  â†’ fetch '/api/parse?anchors=generate'
  â†’ parseResult = {
      partyA: "ABCå…¬å¸",
      partyB: "XYZå…¬å¸",
      parseResultId: "uuid-...",
      clauses: [...]
    }
  â†’ window.ruleReviewParseResultId = parseResult.parseResultId

ã€ç¬¬3æ­¥ã€‘
displayIdentifiedParties(parseResult)
  â†’ å¡«å…… #identified-party-a: "ABCå…¬å¸ (ç”²æ–¹)"
  â†’ å¡«å…… #identified-party-b: "XYZå…¬å¸ (ä¹™æ–¹)"
  â†’ æ˜¾ç¤º #identified-parties-info åŒºåŸŸ

ã€ç¬¬4æ­¥ã€‘
setupStanceSelectionListener()
  â†’ ç›‘å¬ input[name="rule-review-stance"] change äº‹ä»¶
  â†’ ç”¨æˆ·é€‰æ‹©åè‡ªåŠ¨è°ƒç”¨ performOneClickReview(stance)

ã€ç¬¬5æ­¥ã€‘
performOneClickReview(stance)
  â†’ FormData: file + stance
  â†’ fetch '/api/qwen/rule-review/one-click-review'
  â†’ åç«¯å¤„ç†ï¼ˆ6ä¸ªæ­¥éª¤ï¼‰
  â†’ è¿”å› blob (æ‰¹æ³¨åçš„ .docx)

ã€ç¬¬6æ­¥ã€‘
  â†’ è‡ªåŠ¨ä¸‹è½½ï¼š{åŸå}_ä¸€é”®å®¡æŸ¥_{stance}.docx
  â†’ æ˜¾ç¤ºæˆåŠŸæç¤ºï¼š"æ–‡ä»¶å·²ä¸‹è½½ã€‚å·²ä¿å­˜åˆ°æ–‡æ¡£ä¸­å¿ƒã€‚"
  â†’ æ–‡æ¡£å·²åŒæ—¶ä¿å­˜åˆ°ï¼šæ–‡æ¡£ä¸­å¿ƒ/å·²ç”Ÿæˆçš„å®¡æŸ¥æŠ¥å‘Š/
```

---

## âœ… å®ç°æ¸…å•

### ä»£ç ä¿®æ”¹

| æ–‡ä»¶ | è¡Œæ•° | ä¿®æ”¹å†…å®¹ | çŠ¶æ€ |
|-----|------|---------|------|
| main.js | 1414-1492 | é‡æ–°å®ç° startOneClickReview() ä¸ºå¤šæ­¥éª¤æµç¨‹ | âœ… |
| main.js | 1497-1520 | æ–°å¢ displayIdentifiedParties() æ˜¾ç¤ºç”²ä¹™æ–¹ | âœ… |
| main.js | 1526-1558 | æ–°å¢ setupStanceSelectionListener() ç›‘å¬ç«‹åœºé€‰æ‹© | âœ… |
| main.js | 1564-1631 | æ–°å¢ performOneClickReview() æ‰§è¡Œå®¡æŸ¥æµç¨‹ | âœ… |
| main.js | 1389-1424 | æ”¹è¿› resetRuleReviewForm() æ¸…ç†UIçŠ¶æ€ | âœ… |

### ç«¯ç‚¹çŠ¶æ€

| ç«¯ç‚¹ | æ–‡ä»¶ | çŠ¶æ€ | ç”¨é€” |
|-----|------|------|------|
| `/api/parse` | ContractController.java | âœ… ç°æˆå¯ç”¨ | è§£æ + ç”²ä¹™æ–¹æå– |
| `/api/qwen/rule-review/one-click-review` | QwenRuleReviewController.java | âœ… ç°æˆå¯ç”¨ | ä¸€é”®å®¡æŸ¥ + æ–‡æ¡£ä¿å­˜ |

### HTMLå…ƒç´ 

| å…ƒç´  ID | ç”¨é€” | çŠ¶æ€ |
|--------|------|------|
| #identified-parties-info | æ˜¾ç¤ºå·²è¯†åˆ«çš„ç”²ä¹™æ–¹ | âœ… å·²å­˜åœ¨ |
| #identified-party-a | æ˜¾ç¤ºç”²æ–¹åç§° | âœ… å·²å­˜åœ¨ |
| #identified-party-b | æ˜¾ç¤ºä¹™æ–¹åç§° | âœ… å·²å­˜åœ¨ |
| #rule-review-loading | åŠ è½½åŠ¨ç”» | âœ… å·²å­˜åœ¨ |
| #rule-review-stance | ç«‹åœºé€‰æ‹©å•é€‰æ¡† | âœ… å·²å­˜åœ¨ |

---

## ğŸ” æµ‹è¯•éªŒè¯æ¸…å•

### åœºæ™¯1ï¼šæ­£å¸¸æµç¨‹
- [ ] é€‰æ‹©åˆåŒæ–‡ä»¶
- [ ] ç‚¹å‡»"å¼€å§‹ä¸€é”®å®¡æŸ¥"
- [ ] ç­‰å¾…æ–‡ä»¶è§£æï¼ˆé€šå¸¸ 1-2 ç§’ï¼‰
- [ ] éªŒè¯æ˜¾ç¤ºï¼šç”²æ–¹åç§° + ä¹™æ–¹åç§°
- [ ] éªŒè¯ç«‹åœºé€‰æ‹©åŒºåŸŸè¢«é«˜äº®
- [ ] é€‰æ‹©ä¸€ä¸ªç«‹åœºï¼ˆå¦‚"ç”²æ–¹"ï¼‰
- [ ] ç­‰å¾…æ™ºèƒ½å®¡æŸ¥å®Œæˆï¼ˆé€šå¸¸ 5-10 ç§’ï¼‰
- [ ] éªŒè¯æ–‡ä»¶è‡ªåŠ¨ä¸‹è½½ï¼š"{åŸå}_ä¸€é”®å®¡æŸ¥_Aæ–¹.docx"
- [ ] éªŒè¯æˆåŠŸæç¤ºæ˜¾ç¤º
- [ ] éªŒè¯ä¿å­˜ä½ç½®æç¤º

### åœºæ™¯2ï¼šæ–‡æ¡£ä¸­å¿ƒä¿å­˜
- [ ] æ‰“å¼€æ–‡ä»¶æµè§ˆå™¨
- [ ] å¯¼èˆªåˆ°ï¼š{é¡¹ç›®æ ¹}/æ–‡æ¡£ä¸­å¿ƒ/å·²ç”Ÿæˆçš„å®¡æŸ¥æŠ¥å‘Š/
- [ ] éªŒè¯æ–‡ä»¶å·²ä¿å­˜
- [ ] éªŒè¯æ–‡ä»¶åä½¿ç”¨ä¸­æ–‡ï¼šå¦‚ "åˆåŒ_ä¸€é”®å®¡æŸ¥_Aæ–¹.docx"
- [ ] éªŒè¯æ–‡ä»¶èƒ½æ­£å¸¸æ‰“å¼€å¹¶åŒ…å«æ‰¹æ³¨

### åœºæ™¯3ï¼šä¸åŒç«‹åœºæµ‹è¯•
- [ ] ä¸Šä¼ åŒä¸€ä¸ªæ–‡ä»¶ï¼Œåˆ†åˆ«é€‰æ‹©"ä¸­ç«‹"ã€"ç”²æ–¹"ã€"ä¹™æ–¹"è¿›è¡Œå®¡æŸ¥
- [ ] éªŒè¯ä¸‰ä¸ªæ–‡ä»¶åˆ†åˆ«ä¿å­˜ä¸ºï¼š
  - xxx_ä¸€é”®å®¡æŸ¥_neutral.docx
  - xxx_ä¸€é”®å®¡æŸ¥_Aæ–¹.docx
  - xxx_ä¸€é”®å®¡æŸ¥_Bæ–¹.docx
- [ ] éªŒè¯æ‰¹æ³¨å†…å®¹æ ¹æ®ç«‹åœºä¸åŒè€Œä¸åŒ

### åœºæ™¯4ï¼šé”™è¯¯å¤„ç†
- [ ] ä¸Šä¼ æ— æ•ˆæ–‡ä»¶æ ¼å¼ï¼ˆå¦‚ .txtï¼‰â†’ åº”æ˜¾ç¤ºé”™è¯¯æç¤º
- [ ] ç½‘ç»œé”™è¯¯ï¼ˆæ–­ç½‘åç‚¹å‡»æŒ‰é’®ï¼‰â†’ åº”æ˜¾ç¤ºç½‘ç»œé”™è¯¯æç¤º
- [ ] åç«¯é”™è¯¯ï¼ˆQwen ä¸å¯ç”¨ï¼‰â†’ åº”æ˜¾ç¤ºåç«¯é”™è¯¯æç¤º

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

**å…¸å‹åˆåŒå¤„ç†æ—¶é—´** (12 æ¡æ¬¾ï¼Œ~5000 å­—):

| æ­¥éª¤ | è€—æ—¶ | å æ¯” |
|-----|------|------|
| è§£ææ–‡ä»¶ | ~1.5 ç§’ | 15% |
| æ˜¾ç¤ºç”²ä¹™æ–¹ | <100ms | 1% |
| ç”¨æˆ·é€‰æ‹© | ç”¨æˆ·æ“ä½œ | - |
| Qwen å®¡æŸ¥ | ~5-7 ç§’ | 65% |
| æ‰¹æ³¨ + ä¿å­˜ | ~1 ç§’ | 10% |
| ä¸‹è½½ | <100ms | 1% |
| **æ€»è®¡** | **~8-10 ç§’** | **100%** |

ï¼ˆä¸»è¦è€—æ—¶æ˜¯ Qwen AI å®¡æŸ¥ï¼Œå–å†³äºç½‘ç»œå’Œæ¨¡å‹å“åº”ï¼‰

---

## ğŸ¯ åŠŸèƒ½å®Œæˆåº¦

| éœ€æ±‚ | å®ç° | éªŒè¯ |
|-----|------|------|
| æ–‡ä»¶ä¸Šä¼  | âœ… | ç°æˆåŠŸèƒ½ |
| è§£æå¹¶æå–ç”²ä¹™æ–¹ | âœ… | `/api/parse` è¿”å› partyA/partyB |
| æ˜¾ç¤ºç”²ä¹™æ–¹ä¿¡æ¯ | âœ… | displayIdentifiedParties() |
| ç”¨æˆ·é€‰æ‹©ç«‹åœº | âœ… | setupStanceSelectionListener() + è‡ªåŠ¨è§¦å‘ |
| è‡ªåŠ¨æ‰§è¡Œå®¡æŸ¥ | âœ… | performOneClickReview() |
| æ–‡æ¡£æ‰¹æ³¨ | âœ… | QwenRuleReviewController.oneClickReview() |
| ä¿å­˜åˆ°æ–‡æ¡£ä¸­å¿ƒ | âœ… | Files.write() åˆ° æ–‡æ¡£ä¸­å¿ƒ/å·²ç”Ÿæˆçš„å®¡æŸ¥æŠ¥å‘Š/ |
| ä¸­æ–‡æ–‡ä»¶å | âœ… | Paths.get() æ”¯æŒä¸­æ–‡ |
| è‡ªåŠ¨ä¸‹è½½ | âœ… | blob download |

**æ€»ä½“å®Œæˆåº¦**: âœ… **100%** - æ‰€æœ‰éœ€æ±‚å·²å®ç°

---

## ğŸ“ ä½¿ç”¨è¯´æ˜ï¼ˆé¢å‘ç”¨æˆ·ï¼‰

### ä¸€é”®å®¡æŸ¥æ“ä½œæ­¥éª¤

1. **æ‰“å¼€åº”ç”¨**
   - è®¿é—® http://localhost:8080
   - æ‰¾åˆ°"è§„åˆ™å®¡æŸ¥"æ ‡ç­¾é¡µ

2. **ä¸Šä¼ åˆåŒæ–‡ä»¶**
   - ç‚¹å‡»"ğŸ“ é€‰æ‹©åˆåŒæ–‡ä»¶"
   - é€‰æ‹© .docx æˆ– .doc æ ¼å¼çš„æ–‡ä»¶

3. **ç‚¹å‡»"ğŸš€ å¼€å§‹ä¸€é”®å®¡æŸ¥"**
   - ç³»ç»Ÿè‡ªåŠ¨è§£ææ–‡ä»¶
   - æ˜¾ç¤ºè¯†åˆ«çš„ç”²ä¹™æ–¹ä¿¡æ¯

4. **é€‰æ‹©å®¡æŸ¥ç«‹åœº**
   - é€‰æ‹©"ä¸­ç«‹"ï¼šå®¢è§‚ã€å¹³è¡¡çš„å®¡æŸ¥
   - é€‰æ‹©"ç”²æ–¹"ï¼šé‡ç‚¹å…³æ³¨å¯¹ç”²æ–¹ä¸åˆ©çš„æ¡æ¬¾
   - é€‰æ‹©"ä¹™æ–¹"ï¼šé‡ç‚¹å…³æ³¨å¯¹ä¹™æ–¹ä¸åˆ©çš„æ¡æ¬¾

5. **ç­‰å¾…å®¡æŸ¥å®Œæˆ**
   - ç³»ç»Ÿè‡ªåŠ¨è¿›è¡Œæ™ºèƒ½å®¡æŸ¥
   - é€šå¸¸éœ€è¦ 5-10 ç§’ï¼ˆå–å†³äºæ–‡ä»¶å¤§å°å’Œç½‘ç»œï¼‰

6. **è·å¾—ç»“æœ**
   - æ–‡ä»¶è‡ªåŠ¨ä¸‹è½½ï¼š`{æ–‡ä»¶å}_ä¸€é”®å®¡æŸ¥_{ç«‹åœº}.docx`
   - æ–‡ä»¶åŒæ—¶ä¿å­˜åˆ°ï¼šæ–‡æ¡£ä¸­å¿ƒ â†’ å·²ç”Ÿæˆçš„å®¡æŸ¥æŠ¥å‘Š

7. **æŸ¥çœ‹æ‰¹æ³¨**
   - åœ¨ Word ä¸­æ‰“å¼€ä¸‹è½½çš„æ–‡ä»¶
   - æŸ¥çœ‹ AI ç”Ÿæˆçš„æ‰¹æ³¨å’Œå»ºè®®

---

## ğŸš€ éƒ¨ç½²æ£€æŸ¥

ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å‰ç¡®ä¿ï¼š

- [ ] Qwen API å·²é…ç½® (application.properties)
- [ ] æ–‡æ¡£ä¸­å¿ƒç›®å½•å·²åˆ›å»ºæˆ–æœ‰åˆ›å»ºæƒé™
- [ ] å‰ç«¯ä»£ç å·²æ›´æ–°ï¼ˆæœ€æ–°çš„ main.jsï¼‰
- [ ] åç«¯å·²ç¼–è¯‘ï¼ˆmvn clean compileï¼‰
- [ ] è¿›è¡ŒåŠŸèƒ½ç«¯åˆ°ç«¯æµ‹è¯•

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `ARCHITECTURAL_ASSESSMENT.md` - æ¶æ„è¯„ä¼°å’Œç«¯ç‚¹å¤ç”¨åˆ†æ
- `11_ä¸€é”®å¼å®¡æŸ¥åŠŸèƒ½é—®é¢˜ä¿®å¤.md` - ä¹‹å‰çš„é—®é¢˜ä¿®å¤è®°å½•
- `10_ä¸€é”®å¼å®¡æŸ¥åŠŸèƒ½å®Œæˆæ€»ç»“.md` - æœ€åˆå®ç°æ€»ç»“

---

## ğŸ’¾ ç‰ˆæœ¬ä¿¡æ¯

**ç‰ˆæœ¬**: 2.0 (æ”¹è¿›ç‰ˆ)
**å®ç°æ—¥æœŸ**: 2025-10-27
**ç¼–è¯‘çŠ¶æ€**: å¾…éªŒè¯ï¼ˆé¢„æœŸ âœ… SUCCESSï¼‰
**æµ‹è¯•çŠ¶æ€**: ä»£ç é€»è¾‘å®Œæ•´ï¼Œå¾…æ‰‹åŠ¨æµ‹è¯•

---

## æ€»ç»“

âœ… **ä¸€é”®å®¡æŸ¥åŠŸèƒ½å·²å®Œå…¨æ”¹è¿›å®ç°ï¼Œæ”¯æŒå¤šæ­¥éª¤å·¥ä½œæµï¼š**

1. æ–‡ä»¶ä¸Šä¼  â†’ è‡ªåŠ¨è§£æ â†’ æ˜¾ç¤ºç”²ä¹™æ–¹ â†’ ç”¨æˆ·é€‰æ‹©ç«‹åœº â†’ è‡ªåŠ¨å®¡æŸ¥ â†’ è‡ªåŠ¨ä¸‹è½½ + ä¿å­˜

2. å®Œå…¨å¤ç”¨ç°æœ‰ç«¯ç‚¹ï¼Œæ— éœ€ä¿®æ”¹å·²æœ‰åŠŸèƒ½

3. æ‰€æœ‰æ–‡æ¡£è‡ªåŠ¨ä¿å­˜åˆ°æ–‡æ¡£ä¸­å¿ƒï¼Œæ”¯æŒä¸­æ–‡æ–‡ä»¶å

4. æä¾›æ¸…æ™°çš„è¿›åº¦æç¤ºå’Œç”¨æˆ·æŒ‡å¯¼

**ç°åœ¨ç”¨æˆ·å¯ä»¥é€šè¿‡ç®€å•çš„ä¸€é”®æ“ä½œå®Œæˆä»æ–‡ä»¶ä¸Šä¼ åˆ°è·å¾—æ‰¹æ³¨æ–‡æ¡£çš„å…¨éƒ¨æµç¨‹ã€‚**
